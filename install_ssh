if [ ! -f /etc/init.d/ssh ]; then
  apt-get -y install ssh
  echo "SSH installed successfully"
else
  echo "SSH Server is already installed."
fi

echo
echo "New SSH port: $1"
read -p "Do you want to update SSH settings? (y/n): " UPDATE
echo
if [ "$UPDATE" == "y" ]; then

  cp install_ssh_default /etc/ssh/sshd_config
  sed -i "s/Port.*/Port $1/g" /etc/ssh/sshd_config

  #sed -i "s/PermitRootLogin.*/PermitRootLogin no/g" /etc/ssh/sshd_config
  #sed -i "s/#Protocol 2/Protocol 2/g" /etc/ssh/sshd_config
  #sed -i "s/X11Forwarding.*/X11Forwarding no/g" /etc/ssh/sshd_config

  #groupadd sshdusers
  #groupadd sftponly
  #echo "" | tee -a /etc/ssh/sshd_config > /dev/null
  #echo "UseDNS no" | tee -a /etc/ssh/sshd_config > /dev/null
  #echo "AllowGroups sshdusers" >> /etc/ssh/sshd_config
  #mkdir -p /usr/share/terminfo/l/
  #cp /lib/terminfo/l/linux /usr/share/terminfo/l/
  #echo '/usr/lib/openssh/sftp-server' >> /etc/shells
  #echo "Match Group sftponly" >> /etc/ssh/sshd_config
  #echo "ChrootDirectory %h" >> /etc/ssh/sshd_config
  #echo "ForceCommand internal-sftp" >> /etc/ssh/sshd_config
  #echo "AllowTcpForwarding no" >> /etc/ssh/sshd_config
  
  service ssh restart
fi
